<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERAIF - Emergency Radiology AI Interoperability Framework</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2d3748;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #718096;
            font-size: 1.2em;
        }
        
        .emergency-banner {
            background: #f56565;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .status-online { background: #48bb78; }
        .status-degraded { background: #ed8936; }
        .status-offline { background: #f56565; }
        .status-disaster { 
            background: #f56565;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0; }
        }
        
        .hospital-item {
            padding: 12px;
            margin: 10px 0;
            background: #f7fafc;
            border-radius: 8px;
            border-left: 4px solid #48bb78;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .hospital-item.degraded {
            border-left-color: #ed8936;
        }
        
        .hospital-item.offline {
            border-left-color: #f56565;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }
        
        button:hover {
            background: #5a67d8;
            transform: scale(1.05);
        }
        
        button.emergency {
            background: #f56565;
        }
        
        button.emergency:hover {
            background: #e53e3e;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .metric {
            text-align: center;
            padding: 15px;
            background: #edf2f7;
            border-radius: 8px;
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #2d3748;
        }
        
        .metric-label {
            color: #718096;
            margin-top: 5px;
        }
        
        .log-entry {
            padding: 8px;
            margin: 5px 0;
            background: #f7fafc;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .log-entry.error {
            background: #fff5f5;
            color: #c53030;
        }
        
        .log-entry.success {
            background: #f0fff4;
            color: #22543d;
        }
        
        .log-entry.warning {
            background: #fffaf0;
            color: #c05621;
        }
        
        #messageModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 500px;
            width: 90%;
        }
        
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            width: 0%;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .footer {
            text-align: center;
            color: white;
            margin-top: 40px;
        }
        
        .footer a {
            color: white;
            text-decoration: none;
            margin: 0 10px;
        }
        
        /* ERAIF Demo Section Styles */
        .eraif-demo-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 80px 0;
            margin: 60px 0;
            border-radius: 20px;
        }
        
        .demo-header {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .demo-header h2 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .demo-subtitle {
            font-size: 1.2rem;
            color: #6c757d;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .demo-features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .demo-feature {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }
        
        .demo-feature:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }
        
        .demo-feature h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .demo-feature p {
            color: #6c757d;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .feature-list li {
            color: #495057;
            padding: 5px 0;
            position: relative;
            padding-left: 20px;
        }
        
        .feature-list li:before {
            content: "✓";
            color: #28a745;
            font-weight: bold;
            position: absolute;
            left: 0;
        }
        
        .demo-cta {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 50px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(44, 62, 80, 0.3);
        }
        
        .cta-content h3 {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #ecf0f1;
        }
        
        .cta-content p {
            font-size: 1.1rem;
            color: #bdc3c7;
            margin-bottom: 30px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .demo-launch-button {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
            display: inline-block;
        }
        
        .demo-launch-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
            color: white;
            text-decoration: none;
        }
        
        .demo-info-button {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
            display: inline-block;
        }
        
        .demo-info-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
            color: white;
            text-decoration: none;
        }
        
        .demo-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 30px;
            text-align: center;
        }
        
        .stat-item {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid #e9ecef;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #dc3545;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Responsive Design for Demo Section */
        @media (max-width: 768px) {
            .eraif-demo-section {
                padding: 60px 0;
            }
            
            .demo-header h2 {
                font-size: 2rem;
            }
            
            .demo-features-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .demo-cta {
                padding: 40px 20px;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .demo-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .demo-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🚨 ERAIF Emergency Dashboard</h1>
            <p class="subtitle">Emergency Radiology AI Interoperability Framework - Live Demo</p>
            <div id="emergencyBanner" class="emergency-banner">
                ⚠️ EMERGENCY MODE ACTIVE - All hospitals sharing critical imaging
            </div>
        </header>

        <div class="grid">
            <!-- System Status Card -->
            <div class="card">
                <h2>System Status</h2>
                <div id="systemMode">
                    <p><span class="status-indicator status-online"></span> <strong>Mode:</strong> <span id="currentMode">NORMAL</span></p>
                </div>
                <div class="metrics">
                    <div class="metric">
                        <div class="metric-value" id="activeNodes">5</div>
                        <div class="metric-label">Active Nodes</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="messagesSent">0</div>
                        <div class="metric-label">Messages Sent</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="latency">0.3s</div>
                        <div class="metric-label">Avg Latency</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="uptime">99.99%</div>
                        <div class="metric-label">Uptime</div>
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <button onclick="simulateNormal()">Normal Mode</button>
                    <button onclick="simulateDegraded()">Degraded Mode</button>
                    <button class="emergency" onclick="simulateDisaster()">🚨 Disaster Mode</button>
                </div>
            </div>

            <!-- Connected Hospitals Card -->
            <div class="card">
                <h2>Connected Hospitals</h2>
                <div id="hospitalList">
                    <div class="hospital-item" id="hosp1">
                        <span>🏥 County General Hospital</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="hospital-item" id="hosp2">
                        <span>🏥 St. Mary's Medical Center</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="hospital-item" id="hosp3">
                        <span>🏥 Rural Community Hospital</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="hospital-item" id="hosp4">
                        <span>🏥 University Trauma Center</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="hospital-item" id="hosp5">
                        <span>🏥 Veterans Medical Center</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                </div>
                <button onclick="sendTestMessage()" style="width: 100%; margin-top: 20px;">Send Test Image Request</button>
            </div>
        </div>

        <!-- Activity Log Card -->
        <div class="card">
            <h2>Activity Log</h2>
            <div id="activityLog" style="max-height: 300px; overflow-y: auto;">
                <div class="log-entry success">System initialized - ERAIF v0.1.0</div>
                <div class="log-entry">Connecting to hospital network...</div>
                <div class="log-entry success">5 hospitals connected successfully</div>
            </div>
        </div>

        <!-- Simulation Controls Card -->
        <div class="card">
            <h2>Disaster Simulations</h2>
            <p style="margin-bottom: 20px;">Test ERAIF's response to various emergency scenarios:</p>
            <button onclick="simulateHurricane()">🌀 Hurricane Scenario</button>
            <button onclick="simulateCyberAttack()">💻 Cyber Attack</button>
            <button onclick="simulateMassCasualty()">🚑 Mass Casualty Event</button>
            <button onclick="simulatePowerOutage()">⚡ Power Grid Failure</button>
            <div class="progress-bar" id="progressBar" style="display: none;">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
        </div>

        <!-- ERAIF Interactive Demo Section -->
        <section class="eraif-demo-section">
            <div class="container">
                <div class="demo-header">
                    <h2>🚨 Interactive ERAIF Demo</h2>
                    <p class="demo-subtitle">Experience the Emergency Radiology AI Interoperability Framework in action!</p>
                </div>
                
                <div class="demo-features-grid">
                    <div class="demo-feature">
                        <div class="feature-icon">🏥</div>
                        <h3>Hospital Network Management</h3>
                        <p>Create and manage hospital nodes in real-time. Watch as facilities connect and coordinate during emergencies.</p>
                        <ul class="feature-list">
                            <li>Real-time node creation</li>
                            <li>Network status monitoring</li>
                            <li>Connection visualization</li>
                        </ul>
                    </div>
                    
                    <div class="demo-feature">
                        <div class="feature-icon">📨</div>
                        <h3>Emergency Message Handling</h3>
                        <p>Send and receive critical messages between hospitals. Experience the ERAIF protocol in action.</p>
                        <ul class="feature-list">
                            <li>Priority-based messaging</li>
                            <li>Multiple message types</li>
                            <li>Real-time delivery tracking</li>
                        </ul>
                    </div>
                    
                    <div class="demo-feature">
                        <div class="feature-icon">🚨</div>
                        <h3>Emergency Protocol Testing</h3>
                        <p>Activate disaster modes and test emergency response protocols. See how the system adapts.</p>
                        <ul class="feature-list">
                            <li>Mass casualty protocols</li>
                            <li>Disaster mode activation</li>
                            <li>Resource failover testing</li>
                        </ul>
                    </div>
                    
                    <div class="demo-feature">
                        <div class="feature-icon">🤖</div>
                        <h3>AI Analysis Integration</h3>
                        <p>Experience how AI analysis results are integrated into emergency response workflows.</p>
                        <ul class="feature-list">
                            <li>AI findings display</li>
                            <li>Confidence scoring</li>
                            <li>Recommendation systems</li>
                        </ul>
                    </div>
                </div>
                
                <div class="demo-cta">
                    <div class="cta-content">
                        <h3>Ready to Experience ERAIF?</h3>
                        <p>Launch the interactive demo and see how emergency radiology coordination works in real-time.</p>
                    </div>
                    <div class="cta-buttons">
                        <a href="demo/demo.html" class="demo-launch-button">
                            🚀 Launch Interactive Demo
                        </a>
                    </div>
                </div>
                
                <div class="demo-stats">
                    <div class="stat-item">
                        <div class="stat-number">25+</div>
                        <div class="stat-label">Sample Patients</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">56+</div>
                        <div class="stat-label">Imaging Studies</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">4</div>
                        <div class="stat-label">Emergency Scenarios</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">803</div>
                        <div class="stat-label">Total Images</div>
                    </div>
                </div>
            </div>
        </section>

        <div class="footer">
            <p>ERAIF - Saving lives through emergency interoperability</p>
            <p>
                <a href="https://github.com/dshah29/ERAIF" target="_blank">GitHub</a> |
                <a href="#" onclick="showAbout()">About</a> |
                <a href="#" onclick="showTechnical()">Technical Details</a>
            </p>
        </div>
    </div>

    <!-- Message Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal()"></div>
    <div id="messageModal">
        <h3 id="modalTitle">Message</h3>
        <p id="modalContent">Content</p>
        <button onclick="closeModal()">Close</button>
    </div>

    <script>
        let messageCount = 0;
        let currentMode = 'NORMAL';
        
        function addLog(message, type = '') {
            const log = document.getElementById('activityLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${message}`;
            log.insertBefore(entry, log.firstChild);
            
            // Keep only last 10 entries
            while (log.children.length > 10) {
                log.removeChild(log.lastChild);
            }
        }
        
        function updateStatus(mode) {
            currentMode = mode;
            document.getElementById('currentMode').textContent = mode;
            const banner = document.getElementById('emergencyBanner');
            const indicator = document.querySelector('#systemMode .status-indicator');
            
            if (mode === 'DISASTER') {
                banner.style.display = 'block';
                banner.textContent = '⚠️ DISASTER MODE ACTIVE - Emergency protocols engaged';
                indicator.className = 'status-indicator status-disaster';
                document.getElementById('uptime').textContent = '99.9%';
                document.getElementById('latency').textContent = '2.3s';
            } else if (mode === 'DEGRADED') {
                banner.style.display = 'block';
                banner.textContent = '⚠️ DEGRADED MODE - Operating on backup systems';
                banner.style.background = '#ed8936';
                indicator.className = 'status-indicator status-degraded';
                document.getElementById('uptime').textContent = '99.5%';
                document.getElementById('latency').textContent = '1.2s';
            } else {
                banner.style.display = 'none';
                indicator.className = 'status-indicator status-online';
                document.getElementById('uptime').textContent = '99.99%';
                document.getElementById('latency').textContent = '0.3s';
            }
        }
        
        function simulateNormal() {
            updateStatus('NORMAL');
            addLog('Switched to NORMAL mode - All systems operational', 'success');
            resetHospitals();
        }
        
        function simulateDegraded() {
            updateStatus('DEGRADED');
            addLog('Switched to DEGRADED mode - Primary systems offline', 'warning');
            document.getElementById('hosp3').className = 'hospital-item degraded';
            document.getElementById('hosp5').className = 'hospital-item degraded';
            addLog('Rural Community Hospital switched to P2P mesh', 'warning');
            addLog('Veterans Medical Center on backup connection', 'warning');
        }
        
        function simulateDisaster() {
            updateStatus('DISASTER');
            addLog('DISASTER MODE ACTIVATED - Emergency protocols engaged', 'error');
            addLog('Activating all failover systems...', 'warning');
            
            setTimeout(() => {
                addLog('P2P mesh network established', 'success');
                addLog('Satellite backup online', 'success');
                addLog('Emergency sharing enabled for all hospitals', 'success');
            }, 1000);
            
            document.getElementById('hosp2').className = 'hospital-item offline';
            document.getElementById('hosp3').className = 'hospital-item offline';
            
            setTimeout(() => {
                document.getElementById('hosp2').className = 'hospital-item degraded';
                document.getElementById('hosp3').className = 'hospital-item degraded';
                addLog('Hospitals reconnected via emergency mesh', 'success');
            }, 2000);
        }
        
        function resetHospitals() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`hosp${i}`).className = 'hospital-item';
            }
        }
        
        function sendTestMessage() {
            messageCount++;
            document.getElementById('messagesSent').textContent = messageCount;
            
            const hospitals = ['County General', 'St. Mary\'s', 'Rural Community', 'University Trauma', 'Veterans Medical'];
            const modalities = ['CT', 'MRI', 'X-Ray', 'Ultrasound'];
            const bodyParts = ['Head', 'Chest', 'Abdomen', 'Spine'];
            
            const from = hospitals[Math.floor(Math.random() * hospitals.length)];
            const to = hospitals[Math.floor(Math.random() * hospitals.length)];
            const modality = modalities[Math.floor(Math.random() * modalities.length)];
            const bodyPart = bodyParts[Math.floor(Math.random() * bodyParts.length)];
            
            addLog(`Image request: ${from} → ${to} (${modality} ${bodyPart})`, 'success');
            
            if (currentMode === 'DISASTER') {
                setTimeout(() => {
                    addLog(`Routed via P2P mesh network`, 'warning');
                }, 500);
            }
        }
        
        function simulateHurricane() {
            showProgress('Simulating Hurricane Scenario');
            addLog('SIMULATION: Hurricane approaching - preparing for infrastructure failure', 'warning');
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 20;
                updateProgress(progress);
                
                if (progress === 20) addLog('Pre-positioning emergency cache...', 'warning');
                if (progress === 40) addLog('Testing failover systems...', 'warning');
                if (progress === 60) addLog('Power grid failing - switching to backup', 'error');
                if (progress === 80) simulateDisaster();
                if (progress >= 100) {
                    clearInterval(interval);
                    addLog('Hurricane simulation complete - all systems resilient', 'success');
                    hideProgress();
                }
            }, 1000);
        }
        
        function simulateCyberAttack() {
            showProgress('Simulating Cyber Attack');
            addLog('ALERT: Ransomware detected - initiating isolation protocol', 'error');
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 25;
                updateProgress(progress);
                
                if (progress === 25) addLog('Disconnecting from WAN...', 'error');
                if (progress === 50) addLog('Activating air-gapped backup...', 'warning');
                if (progress === 75) addLog('Switching to pre-shared encryption keys...', 'warning');
                if (progress >= 100) {
                    clearInterval(interval);
                    addLog('Isolation complete - operating in secure mode', 'success');
                    hideProgress();
                }
            }, 800);
        }
        
        function simulateMassCasualty() {
            showProgress('Simulating Mass Casualty Event');
            addLog('MASS CASUALTY EVENT DECLARED - 50+ casualties incoming', 'error');
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 20;
                updateProgress(progress);
                
                if (progress === 20) addLog('Activating triage priority mode...', 'warning');
                if (progress === 40) addLog('AI triage assistant online', 'success');
                if (progress === 60) addLog('Clearing non-critical queue...', 'warning');
                if (progress === 80) addLog('All hospitals sharing trauma imaging', 'success');
                if (progress >= 100) {
                    clearInterval(interval);
                    addLog('MCE protocols fully activated', 'success');
                    hideProgress();
                    
                    // Simulate rapid messages
                    for (let i = 0; i < 5; i++) {
                        setTimeout(() => sendTestMessage(), i * 200);
                    }
                }
            }, 600);
        }
        
        function simulatePowerOutage() {
            showProgress('Simulating Power Grid Failure');
            addLog('POWER GRID FAILURE - Switching to emergency power', 'error');
            
            // Make all hospitals go offline briefly
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`hosp${i}`).className = 'hospital-item offline';
            }
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 25;
                updateProgress(progress);
                
                if (progress === 25) addLog('UPS systems engaged...', 'warning');
                if (progress === 50) {
                    addLog('Cellular backup activated...', 'warning');
                    document.getElementById('hosp1').className = 'hospital-item degraded';
                }
                if (progress === 75) {
                    addLog('Satellite connection established...', 'success');
                    document.getElementById('hosp4').className = 'hospital-item degraded';
                }
                if (progress >= 100) {
                    clearInterval(interval);
                    addLog('Emergency power stable - minimal operations', 'success');
                    hideProgress();
                    simulateDegraded();
                }
            }, 1000);
        }
        
        function showProgress(title) {
            document.getElementById('progressBar').style.display = 'block';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressFill').textContent = '0%';
        }
        
        function updateProgress(percent) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressFill').textContent = percent + '%';
        }
        
        function hideProgress() {
            setTimeout(() => {
                document.getElementById('progressBar').style.display = 'none';
            }, 1000);
        }
        
        function showModal(title, content) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalContent').textContent = content;
            document.getElementById('messageModal').style.display = 'block';
            document.getElementById('modalOverlay').style.display = 'block';
        }
        
        function closeModal() {
            document.getElementById('messageModal').style.display = 'none';
            document.getElementById('modalOverlay').style.display = 'none';
        }
        
        function showAbout() {
            showModal('About ERAIF', 
                'ERAIF (Emergency Radiology AI Interoperability Framework) is an open-source protocol ensuring medical imaging systems can communicate during disasters. Developed in response to Hurricane Helene failures that caused preventable deaths, ERAIF provides resilient, vendor-neutral interoperability when traditional infrastructure fails.');
        }
        
        function showTechnical() {
            showModal('Technical Details', 
                'ERAIF implements multi-modal failover (Cloud → VPN → P2P → Satellite), offline-first caching, DICOM/HL7/FHIR compatibility, and emergency override protocols. The system maintains 99.99% uptime even with 60% node failure. Built with Python, Docker, and Kubernetes for easy deployment.');
        }
        
        // Auto-update active nodes randomly
        setInterval(() => {
            if (currentMode === 'NORMAL') {
                const nodes = 3 + Math.floor(Math.random() * 3);
                document.getElementById('activeNodes').textContent = nodes;
            }
        }, 5000);
        
        // Simulate incoming messages periodically
        setInterval(() => {
            if (Math.random() > 0.7) {
                sendTestMessage();
            }
        }, 10000);
        
        // Initial log entry
        addLog('Dashboard connected to ERAIF network', 'success');
    </script>
</body>
</html>
